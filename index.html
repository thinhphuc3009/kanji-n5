<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>√în KANJI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ===================== BASE ===================== */
body{
    margin:0;
    font-family: "Inter", sans-serif;
    background:#f3f5fa;
    color:#222;
}

h2{
    margin:10px 0 20px;
    color:#334;
    font-size:26px;
    font-weight:700;
    text-align:center;
}

.page{
    display:none;
    padding:20px;
    max-width:900px;
    margin:auto;
}

button{
    padding:10px 16px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-size:15px;
    font-weight:600;
    background:#5566ff;
    color:white;
    transition:0.2s;
}
button:hover{
    opacity:0.85;
}

body{
    margin:0;
    font-family: "Inter", sans-serif;
    background:#f3f5fa;
    color:#222;
}

h2{
    margin:10px 0 20px;
    color:#334;
    font-size:26px;
    font-weight:700;
    text-align:center;
}

/* ===================== MENU ===================== */
#menu{
    display:flex;
    justify-content:center;
    gap:10px;
    padding:15px;
    background:white;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
    position:sticky;
    top:0;
    z-index:10;
}

#menu button{
    background:#ffffff;
    color:#333;
    border:2px solid #5566ff;
}
#menu button:hover{
    background:#5566ff;
    color:white;
}

/* ===================== VOCAB PAGE ===================== */
#searchBox{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:2px solid #ccd3ff;
    font-size:16px;
    margin-bottom:20px;
}

table{
    width:100%;
    border-collapse:collapse;
    background:white;
    border-radius:10px;
    overflow:hidden;
    box-shadow:0 2px 7px rgba(0,0,0,0.08);
}

th, td{
    padding:12px;
    text-align:left;
    font-size:16px;
    border-bottom:1px solid #eee;
}
th{
    background:#5566ff;
    color:white;
    font-weight:700;
}

/* ===================== FLASHCARD PAGE ===================== */
#flashGrid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(120px,1fr));
    gap:15px;
}

.flash{
    width:100%;
    height:150px;
    background:#ffffff;
    border-radius:14px;
    perspective:800px;
    cursor:pointer;
}

.flash-inner{
    width:100%;
    height:100%;
    position:relative;
    transition:transform 0.45s ease;
    transform-style:preserve-3d;
}

.flash.flipped .flash-inner{
    transform:rotateY(180deg);
}

.flash-face{
    position:absolute;
    width:100%;
    height:100%;
    backface-visibility:hidden;
    border-radius:14px;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    font-weight:700;
}

.front{
    background:white;
    color:#222;
    font-size:40px;
}
.back{
    background:#5566ff;
    color:white;
    transform:rotateY(180deg);
    font-size:22px;
}

/* ===================== TEST PAGE ===================== */
#quizBox{
    background:white;
    padding:28px;
    border-radius:16px;
    box-shadow:0 8px 30px rgba(20,30,80,0.08);
    max-width:780px;
    margin:auto;
    min-height:140px;
    transition:0.18s;
}

.qTitle{
    font-size:22px;
    font-weight:800;
    margin-bottom:16px;
    color:#172a4a;
    text-align:left;
}

/* progress */
.progressWrap{
    height:10px;
    background:#eef2ff;
    border-radius:10px;
    overflow:hidden;
    margin:8px 0 16px;
}
.progressBar{
    height:100%;
    width:0%;
    background:linear-gradient(90deg,#6a7bff,#3ecf8e);
    transition:width 0.4s ease;
}

/* answer buttons */
.answers{
    display:flex;
    flex-direction:column;
    gap:12px;
    margin-top:6px;
}
.answer{
    padding:14px 16px;
    border-radius:12px;
    border:1px solid rgba(85,102,255,0.12);
    background:#fbfbff;
    cursor:pointer;
    font-size:18px;
    font-weight:700;
    color:#223;
    box-shadow:0 4px 14px rgba(80,90,200,0.04);
    transition:transform 0.12s ease, box-shadow 0.12s ease, background 0.18s;
    user-select:none;
}
.answer:hover{ transform:translateY(-3px); box-shadow:0 8px 24px rgba(80,90,200,0.08); }
.answer.selected{ outline:3px solid rgba(85,102,255,0.12); background:#eef2ff; }
.answer.correct{ background:linear-gradient(90deg,#e6fff0,#c9ffd6); border-color:#00c969; color:#075a2e; box-shadow:none; }
.answer.wrong{ background:linear-gradient(90deg,#fff0f0,#ffd6d6); border-color:#ff4444; color:#4b120f; box-shadow:none; }

/* control buttons */
#nextBtn, #restartBtn{
    background:#5566ff;
    padding:12px 26px;
    font-size:17px;
    border-radius:12px;
    color:white;
    border:none;
    margin:8px;
    font-weight:800;
    box-shadow:0 8px 20px rgba(85,102,255,0.18);
}
#restartBtn{ background:#ff7a45; box-shadow:0 8px 20px rgba(255,122,69,0.14); }
#nextBtn[disabled]{ opacity:0.6; transform:none; cursor:not-allowed; box-shadow:none; }

/* score */
.scoreBox{
    font-size:30px;
    font-weight:900;
    color:#2d3bff;
    text-align:center;
    margin-top:20px;
}

/* small responsive */
@media (max-width:520px){
    .answer{ font-size:16px; padding:12px; }
    #quizBox{ padding:18px; }
}


</style>
</head>

<body>

<!-- ===================== MENU ===================== -->
<div id="menu">
    <button onclick="showPage('vocab')">üìó T·ª´ v·ª±ng</button>
    <button onclick="showPage('flash')">üé¥ Flashcard</button>
    <button onclick="showPage('test')">üìù B√†i test</button>
</div>

<!-- ===================== PAGE: T·ª™ V·ª∞NG ===================== -->
<div id="vocab" class="page">
    <h2>üìó Danh s√°ch Kanji N5</h2>
    <input id="searchBox" placeholder="T√¨m theo Kanji / H√°n Vi·ªát / Nghƒ©a...">
    <table>
        <thead>
            <tr>
                <th>Kanji</th>
                <th>H√°n Vi·ªát</th>
                <th>Nghƒ©a</th>
            </tr>
        </thead>
        <tbody id="vocabBody"></tbody>
    </table>
</div>

<!-- ===================== PAGE: FLASHCARD ===================== -->
<div id="flash" class="page">
    <h2>üé¥ Flashcard Kanji N5</h2>

    <div style="text-align:center; margin-bottom:15px;">
        <button onclick="shuffleFlash()">üîÄ Tr·ªôn th·∫ª</button>
        <button onclick="showAllFront()">üîÑ Reset</button>
    </div>

    <div id="flashGrid"></div>
</div>

<!-- ===================== PAGE: TEST 10 C√ÇU ===================== -->
<div id="test" class="page">
    <h2>üìù B√†i test 10 c√¢u</h2>

    <div id="quizBox"></div>

    <div style="text-align:center; margin-top:18px;">
        <button id="nextBtn" onclick="nextQuestion()" style="display:none;">‚û° Ti·∫øp theo</button>
        <button id="restartBtn" onclick="startQuiz()" style="display:none;">üîÅ L√†m l·∫°i</button>
    </div>

    <div id="score" class="scoreBox"></div>
</div>

<script>
/* =======================================
   D·ªÆ LI·ªÜU KANJI (b·∫°n d√°n list 103 ch·ªØ v√†o)
========================================== */
const kanjiData = [
    {kanji:'Êó•', hv:'nh·∫≠t', on:'„Éã„ÉÅ„Éª„Ç∏„ÉÑ', kun:'„Å≤„Éª„Å≥„Éª„Åã', mean:'ng√†y, m·∫∑t tr·ªùi', vocab:['Êó•(„Å≤)','Êó•Êú¨(„Å´„Åª„Çì)','Êó•ÊõúÊó•(„Å´„Å°„Çà„ÅÜ„Å≥)']},
    {kanji:'Êúà', hv:'nguy·ªát', on:'„Ç≤„ÉÑ„Éª„Ç¨„ÉÑ', kun:'„Å§„Åç', mean:'th√°ng, m·∫∑t trƒÉng', vocab:['Êúà(„Å§„Åç)','ÊúàÊõúÊó•(„Åí„Å§„Çà„ÅÜ„Å≥)','‰ªäÊúà(„Åì„Çì„Åí„Å§)']},
    {kanji:'ÁÅ´', hv:'ho·∫£', on:'„Ç´', kun:'„Å≤', mean:'l·ª≠a', vocab:['ÁÅ´(„Å≤)','ÁÅ´ÊõúÊó•(„Åã„Çà„ÅÜ„Å≥)']},
    {kanji:'Ê∞¥', hv:'thu·ª∑', on:'„Çπ„Ç§', kun:'„Åø„Åö', mean:'n∆∞·ªõc', vocab:['Ê∞¥(„Åø„Åö)','Ê∞¥ÊõúÊó•(„Åô„ÅÑ„Çà„ÅÜ„Å≥)']},
    {kanji:'Êú®', hv:'m·ªôc', on:'„É¢„ÇØ', kun:'„Åç', mean:'c√¢y, g·ªó', vocab:['Êú®(„Åç)','Êú®ÊõúÊó•(„ÇÇ„Åè„Çà„ÅÜ„Å≥)']},
    {kanji:'Èáë', hv:'kim', on:'„Ç≠„É≥', kun:'„Åã„Å≠', mean:'v√†ng, ti·ªÅn', vocab:['Èáë(„Åã„Å≠)','ÈáëÊõúÊó•(„Åç„Çì„Çà„ÅÜ„Å≥)']},
    {kanji:'Âúü', hv:'th·ªï', on:'„Éâ', kun:'„Å§„Å°', mean:'ƒë·∫•t', vocab:['Âúü(„Å§„Å°)','ÂúüÊõúÊó•(„Å©„Çà„ÅÜ„Å≥)']},
    {kanji:'Êú¨', hv:'b·∫£n', on:'„Éõ„É≥', kun:'„ÇÇ„Å®', mean:'s√°ch, g·ªëc', vocab:['Êú¨(„Åª„Çì)','Êó•Êú¨(„Å´„Åª„Çì)']},

    {kanji:'‰∫∫', hv:'nh√¢n', on:'„Ç∏„É≥„Éª„Éã„É≥', kun:'„Å≤„Å®', mean:'ng∆∞·ªùi', vocab:['‰∫∫(„Å≤„Å®)','Êó•Êú¨‰∫∫(„Å´„Åª„Çì„Åò„Çì)']},
    {kanji:'Áî∑', hv:'nam', on:'„ÉÄ„É≥', kun:'„Åä„Å®„Åì', mean:'ƒë√†n √¥ng', vocab:['Áî∑(„Åä„Å®„Åì)']},
    {kanji:'Â•≥', hv:'n·ªØ', on:'„Ç∏„Éß', kun:'„Åä„Çì„Å™', mean:'ph·ª• n·ªØ', vocab:['Â•≥(„Åä„Çì„Å™)']},
    {kanji:'Â≠ê', hv:'t·ª≠', on:'„Ç∑', kun:'„Åì', mean:'tr·∫ª con', vocab:['Â≠ê„Å©„ÇÇ(„Åì„Å©„ÇÇ)']},
    {kanji:'Áà∂', hv:'ph·ª•', on:'„Éï', kun:'„Å°„Å°', mean:'cha', vocab:['Áà∂(„Å°„Å°)']},
    {kanji:'ÊØç', hv:'m·∫´u', on:'„Éú', kun:'„ÅØ„ÅØ', mean:'m·∫π', vocab:['ÊØç(„ÅØ„ÅØ)']},
    {kanji:'ÂÖÑ', hv:'huynh', on:'„Ç±„Ç§', kun:'„ÅÇ„Å´', mean:'anh trai', vocab:['ÂÖÑ(„ÅÇ„Å´)']},
    {kanji:'Âßâ', hv:'t·ªâ', on:'„Ç∑', kun:'„ÅÇ„Å≠', mean:'ch·ªã g√°i', vocab:['Âßâ(„ÅÇ„Å≠)']},
    {kanji:'Âºü', hv:'ƒë·ªá', on:'„ÉÜ„Ç§', kun:'„Åä„Å®„ÅÜ„Å®', mean:'em trai', vocab:['Âºü(„Åä„Å®„ÅÜ„Å®)']},
    {kanji:'Â¶π', hv:'mu·ªôi', on:'„Éû„Ç§', kun:'„ÅÑ„ÇÇ„ÅÜ„Å®', mean:'em g√°i', vocab:['Â¶π(„ÅÑ„ÇÇ„ÅÜ„Å®)']},

    {kanji:'Â±±', hv:'s∆°n', on:'„Çµ„É≥', kun:'„ÇÑ„Åæ', mean:'n√∫i', vocab:['Â±±(„ÇÑ„Åæ)','ÂØåÂ£´Â±±(„Åµ„Åò„Åï„Çì)']},
    {kanji:'Â∑ù', hv:'xuy√™n', on:'„Çª„É≥', kun:'„Åã„Çè', mean:'s√¥ng', vocab:['Â∑ù(„Åã„Çè)']},
    {kanji:'Áî∞', hv:'ƒëi·ªÅn', on:'„Éá„É≥', kun:'„Åü', mean:'ru·ªông', vocab:['Áî∞„Çì„Åº(„Åü„Çì„Åº)']},
    {kanji:'Á©∫', hv:'kh√¥ng', on:'„ÇØ„Ç¶', kun:'„Åù„Çâ', mean:'b·∫ßu tr·ªùi', vocab:['Á©∫(„Åù„Çâ)']},
    {kanji:'Â§©', hv:'thi√™n', on:'„ÉÜ„É≥', kun:'„ÅÇ„Åæ', mean:'tr·ªùi', vocab:['Â§©Ê∞ó(„Å¶„Çì„Åç)']},
    {kanji:'Ê∞ó', hv:'kh√≠', on:'„Ç≠', kun:'', mean:'kh√≠, tinh th·∫ßn', vocab:['ÂÖÉÊ∞ó(„Åí„Çì„Åç)','Â§©Ê∞ó(„Å¶„Çì„Åç)']},

    {kanji:'Ëä±', hv:'hoa', on:'„Ç´', kun:'„ÅØ„Å™', mean:'hoa', vocab:['Ëä±(„ÅØ„Å™)']},
    {kanji:'Ëçâ', hv:'th·∫£o', on:'„ÇΩ„Ç¶', kun:'„Åè„Åï', mean:'c·ªè', vocab:['Ëçâ(„Åè„Åï)']},
    {kanji:'Ëô´', hv:'tr√πng', on:'„ÉÅ„É•„Ç¶', kun:'„ÇÄ„Åó', mean:'c√¥n tr√πng', vocab:['Ëô´(„ÇÄ„Åó)']},
    {kanji:'Áä¨', hv:'khuy·ªÉn', on:'„Ç±„É≥', kun:'„ÅÑ„Å¨', mean:'ch√≥', vocab:['Áä¨(„ÅÑ„Å¨)']},
    {kanji:'Áâõ', hv:'ng∆∞u', on:'„ÇÆ„É•„Ç¶', kun:'„ÅÜ„Åó', mean:'b√≤', vocab:['Áâõ(„ÅÜ„Åó)']},
    {kanji:'È¶¨', hv:'m√£', on:'„Éê', kun:'„ÅÜ„Åæ', mean:'ng·ª±a', vocab:['È¶¨(„ÅÜ„Åæ)']},

    {kanji:'È≠ö', hv:'ng∆∞', on:'„ÇÆ„Éß', kun:'„Åï„Åã„Å™', mean:'c√°', vocab:['È≠ö(„Åï„Åã„Å™)']},
    {kanji:'È≥•', hv:'ƒëi·ªÉu', on:'„ÉÅ„Éß„Ç¶', kun:'„Å®„Çä', mean:'chim', vocab:['È≥•(„Å®„Çä)']},
    {kanji:'Èõ®', hv:'v≈©', on:'„Ç¶', kun:'„ÅÇ„ÇÅ', mean:'m∆∞a', vocab:['Èõ®(„ÅÇ„ÇÅ)']},
    {kanji:'È¢®', hv:'phong', on:'„Éï„Ç¶', kun:'„Åã„Åú', mean:'gi√≥', vocab:['È¢®(„Åã„Åú)']},
    {kanji:'Èõ™', hv:'tuy·∫øt', on:'„Çª„ÉÑ', kun:'„ÇÜ„Åç', mean:'tuy·∫øt', vocab:['Èõ™(„ÇÜ„Åç)']},
    {kanji:'Èõª', hv:'ƒëi·ªán', on:'„Éá„É≥', kun:'', mean:'ƒëi·ªán', vocab:['ÈõªÊ∞ó(„Åß„Çì„Åç)']},

    {kanji:'Èü≥', hv:'√¢m', on:'„Ç™„É≥', kun:'„Åä„Å®', mean:'√¢m thanh', vocab:['Èü≥(„Åä„Å®)']},
    {kanji:'Ê•Ω', hv:'l·∫°c', on:'„Ç¨„ÇØ', kun:'„Åü„ÅÆ„Åó„ÅÑ', mean:'vui', vocab:['Ê•Ω„Åó„ÅÑ(„Åü„ÅÆ„Åó„ÅÑ)']},
    {kanji:'Âäõ', hv:'l·ª±c', on:'„É™„Éß„ÇØ', kun:'„Å°„Åã„Çâ', mean:'s·ª©c m·∫°nh', vocab:['Âäõ(„Å°„Åã„Çâ)']},
    {kanji:'‰Ωì', hv:'th·ªÉ', on:'„Çø„Ç§', kun:'„Åã„Çâ„Å†', mean:'c∆° th·ªÉ', vocab:['‰Ωì(„Åã„Çâ„Å†)']},
    {kanji:'ÂøÉ', hv:'t√¢m', on:'„Ç∑„É≥', kun:'„Åì„Åì„Çç', mean:'tr√°i tim', vocab:['ÂøÉ(„Åì„Åì„Çç)']},

    {kanji:'Êâã', hv:'th·ªß', on:'„Ç∑„É•', kun:'„Å¶', mean:'tay', vocab:['Êâã(„Å¶)']},
    {kanji:'Ë∂≥', hv:'t√∫c', on:'„ÇΩ„ÇØ', kun:'„ÅÇ„Åó', mean:'ch√¢n', vocab:['Ë∂≥(„ÅÇ„Åó)']},
    {kanji:'ÁõÆ', hv:'m·ª•c', on:'„É¢„ÇØ', kun:'„ÇÅ', mean:'m·∫Øt', vocab:['ÁõÆ(„ÇÅ)']},
    {kanji:'Âè£', hv:'kh·∫©u', on:'„Ç≥„Ç¶', kun:'„Åè„Å°', mean:'mi·ªáng', vocab:['Âè£(„Åè„Å°)']},
    {kanji:'ËÄ≥', hv:'nhƒ©', on:'„Ç∏', kun:'„Åø„Åø', mean:'tai', vocab:['ËÄ≥(„Åø„Åø)']},

    {kanji:'ÁôΩ', hv:'b·∫°ch', on:'„Éè„ÇØ', kun:'„Åó„Çç', mean:'tr·∫Øng', vocab:['ÁôΩ„ÅÑ(„Åó„Çç„ÅÑ)']},
    {kanji:'Èùí', hv:'thanh', on:'„Çª„Ç§', kun:'„ÅÇ„Åä', mean:'xanh', vocab:['Èùí„ÅÑ(„ÅÇ„Åä„ÅÑ)']},
    {kanji:'Ëµ§', hv:'x√≠ch', on:'„Çª„Ç≠', kun:'„ÅÇ„Åã', mean:'ƒë·ªè', vocab:['Ëµ§„ÅÑ(„ÅÇ„Åã„ÅÑ)']},
    {kanji:'Èªí', hv:'h·∫Øc', on:'„Ç≥„ÇØ', kun:'„Åè„Çç', mean:'ƒëen', vocab:['Èªí„ÅÑ(„Åè„Çç„ÅÑ)']},

    {kanji:'Ë™û', hv:'ng·ªØ', on:'„Ç¥', kun:'„Åã„Åü„Çã', mean:'ng√¥n ng·ªØ', vocab:['Êó•Êú¨Ë™û(„Å´„Åª„Çì„Åî)','Ëã±Ë™û(„Åà„ÅÑ„Åî)']},
    {kanji:'Êñá', hv:'vƒÉn', on:'„Éñ„É≥', kun:'„Åµ„Åø', mean:'vƒÉn, c√¢u', vocab:['Êñá(„Å∂„Çì)']},
    {kanji:'Ê†°', hv:'hi·ªáu', on:'„Ç≥„Ç¶', kun:'', mean:'tr∆∞·ªùng h·ªçc', vocab:['Â≠¶Ê†°(„Åå„Å£„Åì„ÅÜ)']},

    {kanji:'ËÅû', hv:'vƒÉn', on:'„Éñ„É≥', kun:'„Åç„Åè', mean:'nghe', vocab:['ËÅû„Åè(„Åç„Åè)']},
    {kanji:'Ë®Ä', hv:'ng√¥n', on:'„Ç≤„É≥', kun:'„ÅÑ„ÅÜ', mean:'n√≥i', vocab:['Ë®Ä„ÅÜ(„ÅÑ„ÅÜ)']},
    {kanji:'Ë™≠', hv:'ƒë·ªôc', on:'„Éâ„ÇØ', kun:'„Çà„ÇÄ', mean:'ƒë·ªçc', vocab:['Ë™≠„ÇÄ(„Çà„ÇÄ)']},
    {kanji:'Êõ∏', hv:'th∆∞', on:'„Ç∑„Éß', kun:'„Åã„Åè', mean:'vi·∫øt', vocab:['Êõ∏„Åè(„Åã„Åè)']},
    {kanji:'Ë¶ã', hv:'ki·∫øn', on:'„Ç±„É≥', kun:'„Åø„Çã', mean:'nh√¨n', vocab:['Ë¶ã„Çã(„Åø„Çã)']},

    {kanji:'È£ü', hv:'th·ª±c', on:'„Ç∑„Éß„ÇØ', kun:'„Åü„Åπ„Çã', mean:'ƒÉn', vocab:['È£ü„Åπ„Çã(„Åü„Åπ„Çã)']},
    {kanji:'È£≤', hv:'·∫©m', on:'„Ç§„É≥', kun:'„ÅÆ„ÇÄ', mean:'u·ªëng', vocab:['È£≤„ÇÄ(„ÅÆ„ÇÄ)']},

    {kanji:'Ë≤∑', hv:'m√£i', on:'„Éê„Ç§', kun:'„Åã„ÅÜ', mean:'mua', vocab:['Ë≤∑„ÅÜ(„Åã„ÅÜ)']},
    {kanji:'Â£≤', hv:'m·∫°i', on:'„Éê„Ç§', kun:'„ÅÜ„Çã', mean:'b√°n', vocab:['Â£≤„Çã(„ÅÜ„Çã)']},

    {kanji:'Ëµ∑', hv:'kh·ªüi', on:'„Ç≠', kun:'„Åä„Åç„Çã', mean:'th·ª©c d·∫≠y', vocab:['Ëµ∑„Åç„Çã(„Åä„Åç„Çã)']},
    {kanji:'Ê≠©', hv:'b·ªô', on:'„Éõ', kun:'„ÅÇ„Çã„Åè', mean:'ƒëi b·ªô', vocab:['Ê≠©„Åè(„ÅÇ„Çã„Åè)']},
    {kanji:'Ëµ∞', hv:'t·∫©u', on:'„ÇΩ„Ç¶', kun:'„ÅØ„Åó„Çã', mean:'ch·∫°y', vocab:['Ëµ∞„Çã(„ÅØ„Åó„Çã)']},

    {kanji:'ÂÖ•', hv:'nh·∫≠p', on:'„Éã„É•„Ç¶', kun:'„ÅØ„ÅÑ„Çã', mean:'v√†o', vocab:['ÂÖ•„Çã(„ÅØ„ÅÑ„Çã)']},
    {kanji:'Âá∫', hv:'xu·∫•t', on:'„Ç∑„É•„ÉÑ', kun:'„Åß„Çã„Éª„Å†„Åô', mean:'ra', vocab:['Âá∫„Çã(„Åß„Çã)']},

    {kanji:'È´ò', hv:'cao', on:'„Ç≥„Ç¶', kun:'„Åü„Åã„ÅÑ', mean:'cao, ƒë·∫Øt', vocab:['È´ò„ÅÑ(„Åü„Åã„ÅÑ)']},
    {kanji:'ÂÆâ', hv:'an', on:'„Ç¢„É≥', kun:'„ÇÑ„Åô„ÅÑ', mean:'r·∫ª, an to√†n', vocab:['ÂÆâ„ÅÑ(„ÇÑ„Åô„ÅÑ)']},
    {kanji:'Êñ∞', hv:'t√¢n', on:'„Ç∑„É≥', kun:'„ÅÇ„Åü„Çâ„Åó„ÅÑ', mean:'m·ªõi', vocab:['Êñ∞„Åó„ÅÑ(„ÅÇ„Åü„Çâ„Åó„ÅÑ)']},
    {kanji:'Âè§', hv:'c·ªï', on:'„Ç≥', kun:'„Åµ„Çã„ÅÑ', mean:'c≈©', vocab:['Âè§„ÅÑ(„Åµ„Çã„ÅÑ)']},

    {kanji:'Â§ö', hv:'ƒëa', on:'„Çø', kun:'„Åä„Åä„ÅÑ', mean:'nhi·ªÅu', vocab:['Â§ö„ÅÑ(„Åä„Åä„ÅÑ)']},
    {kanji:'Â∞ë', hv:'thi·ªÉu', on:'„Ç∑„Éß„Ç¶', kun:'„Åô„Åè„Å™„ÅÑ', mean:'√≠t', vocab:['Â∞ë„Å™„ÅÑ(„Åô„Åè„Å™„ÅÑ)']},

    {kanji:'Èï∑', hv:'tr∆∞·ªùng', on:'„ÉÅ„Éß„Ç¶', kun:'„Å™„Åå„ÅÑ', mean:'d√†i', vocab:['Èï∑„ÅÑ(„Å™„Åå„ÅÑ)']},
    {kanji:'Áü≠', hv:'ƒëo·∫£n', on:'„Çø„É≥', kun:'„Åø„Åò„Åã„ÅÑ', mean:'ng·∫Øn', vocab:['Áü≠„ÅÑ(„Åø„Åò„Åã„ÅÑ)']},

    {kanji:'Êòé', hv:'minh', on:'„É°„Ç§', kun:'„ÅÇ„Åã„Çã„ÅÑ', mean:'s√°ng', vocab:['Êòé„Çã„ÅÑ(„ÅÇ„Åã„Çã„ÅÑ)']},
    {kanji:'Êöó', hv:'√°m', on:'„Ç¢„É≥', kun:'„Åè„Çâ„ÅÑ', mean:'t·ªëi', vocab:['Êöó„ÅÑ(„Åè„Çâ„ÅÑ)']},

    {kanji:'Âº∑', hv:'c∆∞·ªùng', on:'„Ç≠„Éß„Ç¶', kun:'„Å§„Çà„ÅÑ', mean:'m·∫°nh', vocab:['Âº∑„ÅÑ(„Å§„Çà„ÅÑ)']},
    {kanji:'Âº±', hv:'nh∆∞·ª£c', on:'„Ç∏„É£„ÇØ', kun:'„Çà„Çè„ÅÑ', mean:'y·∫øu', vocab:['Âº±„ÅÑ(„Çà„Çè„ÅÑ)']},

    {kanji:'Âèã', hv:'h·ªØu', on:'„É¶„Ç¶', kun:'„Å®„ÇÇ', mean:'b·∫°n', vocab:['ÂèãÈÅî(„Å®„ÇÇ„Å†„Å°)']},

    {kanji:'ÊØé', hv:'m·ªói', on:'„Éû„Ç§', kun:'', mean:'m·ªói', vocab:['ÊØéÊó•(„Åæ„ÅÑ„Å´„Å°)']},
    {kanji:'ÈÄ±', hv:'chu', on:'„Ç∑„É•„Ç¶', kun:'', mean:'tu·∫ßn', vocab:['‰ªäÈÄ±(„Åì„Çì„Åó„ÇÖ„ÅÜ)']},
    {kanji:'Êõú', hv:'di·ªáu', on:'„É®„Ç¶', kun:'', mean:'th·ª©', vocab:['Êó•ÊõúÊó•(„Å´„Å°„Çà„ÅÜ„Å≥)']},

    {kanji:'Âçà', hv:'ng·ªç', on:'„Ç¥', kun:'', mean:'gi·ªØa ng√†y', vocab:['ÂçàÂâç(„Åî„Åú„Çì)','ÂçàÂæå(„Åî„Åî)']},
    {kanji:'Ââç', hv:'ti·ªÅn', on:'„Çº„É≥', kun:'„Åæ„Åà', mean:'tr∆∞·ªõc', vocab:['Ââç(„Åæ„Åà)']},
    {kanji:'Âæå', hv:'h·∫≠u', on:'„Ç¥„Éª„Ç≥„Ç¶', kun:'„ÅÜ„Åó„Çç', mean:'sau', vocab:['Âæå„Çç(„ÅÜ„Åó„Çç)']},
];


/* =======================================
   CHUY·ªÇN TRANG
========================================== */
function showPage(id){
    document.querySelectorAll(".page").forEach(p=>p.style.display="none");
    document.getElementById(id).style.display="block";

    if(id==="flash") renderFlashcards();
    if(id==="test") initTestPage();

}
showPage("vocab");

/* =======================================
   T·ª™ V·ª∞NG + T√åM KI·∫æM
========================================== */
function renderVocab(list = kanjiData){
    const body = document.getElementById("vocabBody");
    body.innerHTML = "";

    list.forEach(k=>{
        body.innerHTML += `
            <tr>
                <td>${k.kanji}</td>
                <td>${k.hv}</td>
                <td>${k.mean}</td>
            </tr>`;
    });
}
renderVocab();

document.getElementById("searchBox").oninput = e=>{
    const s = e.target.value.toLowerCase();
    const filtered = kanjiData.filter(k =>
        k.kanji.includes(s) ||
        k.hv.toLowerCase().includes(s) ||
        k.mean.toLowerCase().includes(s)
    );
    renderVocab(filtered);
};

/* =======================================
   FLASHCARD
========================================== */
function renderFlashcards(list = kanjiData){
    const box = document.getElementById("flashGrid");
    box.innerHTML = "";

    list.forEach(k=>{
        const card = document.createElement("div");
        card.className = "flash";

        card.innerHTML = `
            <div class="flash-inner">
                <div class="flash-face front">${k.kanji}<br><span style="font-size:15px;">${k.hv}</span></div>
                <div class="flash-face back">${k.mean}</div>
            </div>
        `;
        card.onclick = ()=> card.classList.toggle("flipped");

        box.appendChild(card);
    });
}

function shuffleFlash(){
    renderFlashcards([...kanjiData].sort(()=>Math.random()-0.5));
}
function showAllFront(){
    document.querySelectorAll(".flash").forEach(c=>c.classList.remove("flipped"));
}

/* =======================================
   TEST T·ª™NG C√ÇU (TR·∫ÆC NGHI·ªÜM) ‚Äî B·∫¢N KH√îNG L·ªñI
========================================== */
let quiz = [];
let current = 0;
let scoreCount = 0;

function initTestPage() {
    startQuiz();
}

function startQuiz() {
    quiz = [...kanjiData].sort(() => Math.random() - 0.5).slice(0, 10);
    current = 0;
    scoreCount = 0;

    document.getElementById("score").innerHTML = "";
    document.getElementById("restartBtn").style.display = "none";
    document.getElementById("nextBtn").style.display = "inline-block";
    document.getElementById("nextBtn").disabled = false;
    document.getElementById("nextBtn").textContent = "‚û° Ti·∫øp theo";

    loadQuestion();
}

function loadQuestion() {
    const q = quiz[current];

    // T·∫°o 3 ƒë√°p √°n sai (d·ª±a tr√™n mean)
    let wrong = [...kanjiData]
        .filter(k => k.mean !== q.mean)
        .sort(() => Math.random() - 0.5)
        .slice(0, 3)
        .map(k => k.mean);

    let answers = [...wrong, q.mean].sort(() => Math.random() - 0.5);

    document.getElementById("quizBox").innerHTML = `
        <div class="qTitle"><b>C√¢u ${current + 1}/10:</b> <span style="font-weight:700; font-size:22px;">${q.kanji}</span> <small style="color:#567; font-weight:600; margin-left:8px;">(${q.hv})</small></div>

        <div class="progressWrap"><div class="progressBar" style="width:${((current)/10)*100}%;"></div></div>

        <div style="font-size:15px; color:#445; margin-bottom:8px;">Ch·ªçn nghƒ©a ƒë√∫ng:</div>

        <div class="answers">
            ${answers.map(a => `<div class="answer" data-value="${a}">${a}</div>`).join("")}
        </div>
    `;

    // ch·ªçn ƒë√°p √°n khi click
    document.querySelectorAll("#quizBox .answer").forEach(el=>{
        el.onclick = () => {
            // n·∫øu ƒë√£ reveal (c√≥ class correct/wrong) th√¨ ignore
            if (document.querySelector("#quizBox .answer.correct")) return;

            document.querySelectorAll("#quizBox .answer").forEach(x=>x.classList.remove("selected"));
            el.classList.add("selected");
        };
    });

    // ·∫©n restart, enable next
    document.getElementById("restartBtn").style.display = "none";
    document.getElementById("nextBtn").disabled = false;
}

function nextQuestion() {
    const selected = document.querySelector("#quizBox .answer.selected");

    if (!selected) {
        alert("B·∫°n c·∫ßn ch·ªçn 1 ƒë√°p √°n!");
        return;
    }

    // disable further selection and show feedback
    document.querySelectorAll("#quizBox .answer").forEach(a=>a.style.pointerEvents="none");

    const correctValue = quiz[current].mean;
    if (selected.dataset.value === correctValue) {
        scoreCount++;
        selected.classList.add("correct");
    } else {
        selected.classList.add("wrong");
        // highlight ƒë√∫ng
        const correctEl = Array.from(document.querySelectorAll("#quizBox .answer")).find(x=>x.dataset.value===correctValue);
        if (correctEl) correctEl.classList.add("correct");
    }

    // update progress bar to include current answered
    const pb = document.querySelector("#quizBox .progressBar");
    if (pb) pb.style.width = `${((current+1)/10)*100}%`;

    current++;

    // n·∫øu v·∫´n c√≤n c√¢u, ch·ªù 700ms r·ªìi chuy·ªÉn ho·∫∑c b·∫≠t n√∫t ti·∫øp
    if (current >= 10) {
        // show final score after short delay
        setTimeout(()=> finishQuiz(),800);
    } else {
        // next question after short delay
        setTimeout(()=> loadQuestion(),700);
    }
}

function finishQuiz() {
    document.getElementById("quizBox").innerHTML = "";
    document.getElementById("nextBtn").style.display = "none";

    document.getElementById("score").innerHTML =
        `üéâ B·∫°n ƒë√∫ng <b>${scoreCount}/10</b>`;

    document.getElementById("restartBtn").style.display = "inline-block";
}

</script>

</body>
</html>

